---
import SectionHeader from "../SectionHeader.astro"
import StoreBadge from "../ui/StoreBadge.astro"
import R4DRalphOSCard from "./R4DRalphOSCard.astro"
import R4DRalphdCard from "./R4DRalphdCard.astro"

const releaseStores = [
	{
		os: "Linux",
		osIconPath: "/icons/os/linux.svg",
		stores: [
			{ name: "Flathub", color: "#000000", iconPath: "/icons/stores/flathub.svg" },
			{ name: "AUR", color: "#1793D1", iconPath: "/icons/stores/archlinux.svg" },
			{ name: "AppImage", color: "#222222", iconPath: "/icons/stores/appimage.svg" },
		],
	},
	{
		os: "macOS",
		osIconPath: "/icons/os/macos.svg",
		stores: [
			{ name: "Homebrew", color: "#FBB040", textColor: "#ffffff", iconPath: "/icons/stores/homebrew.svg" },
			{ name: "Mac App Store", color: "#0D96F6", iconPath: "/icons/stores/appstore.svg" },
		],
	},
	{
		os: "Android",
		osIconPath: "/icons/os/android.svg",
		stores: [
			{ name: "Google Play", color: "#34A853", iconPath: "/icons/stores/googleplay.svg" },
			{ name: "F-Droid", color: "#1976D2", iconPath: "/icons/stores/fdroid.svg" },
		],
	},
	{
		os: "iOS",
		osIconPath: "/icons/os/ios.svg",
		stores: [
			{ name: "App Store", color: "#0D96F6", iconPath: "/icons/stores/appstore.svg" },
			{ name: "TestFlight", color: "#0A84FF", iconPath: "/icons/stores/testflight.svg" },
		],
	},
]
---

<section id="r4d-availability" class="py-16 section-surface">
	<div class="container max-w-6xl">
		<SectionHeader
			label="Download"
			title="Release channels are opening soon"
			highlight="Desktop stores first. Mobile stores follow after."
			centered={true}
			accent="mustard"
		/>

		<div class="r4d-store-grid mt-8 grid gap-4">
			{releaseStores.map((group) => (
				<article class="r4d-os-column ui-panel ui-panel-muted h-full p-4">
					<div class="r4d-os-head">
						<div class="r4d-os-title">
							<span class="r4d-os-icon" aria-hidden="true" style={`--os-icon:url('${group.osIconPath}')`} />
							<h3 class="r4d-os-name">{group.os}</h3>
						</div>
					</div>
					<div class="r4d-store-list mt-3">
						{group.stores.map((store) => (
							<StoreBadge
								label={store.name}
								color={store.color}
								textColor={store.textColor}
								iconPath={store.iconPath}
							/>
						))}
					</div>
				</article>
			))}
		</div>

		<div class="r4d-disclaimer-grid mt-6">
			<div class="ui-panel ui-panel-muted h-full p-4 r4d-disclaimer-col">
				<R4DRalphOSCard />
			</div>
			<div class="ui-panel ui-panel-muted h-full p-4 r4d-disclaimer-col">
				<R4DRalphdCard />
			</div>
		</div>
	</div>
</section>

<style>
	.r4d-store-grid {
		grid-template-columns: repeat(1, minmax(0, 1fr));
	}

	.r4d-os-head {
		display: flex;
		align-items: center;
		justify-content: space-between;
		gap: 0.5rem;
		padding-bottom: 0.4rem;
		border-bottom: 1px solid var(--border);
	}

	.r4d-os-title {
		display: inline-flex;
		align-items: center;
		gap: 0.48rem;
	}

	.r4d-os-icon {
		display: inline-block;
		width: 1rem;
		height: 1rem;
		flex: 0 0 auto;
		background: color-mix(in srgb, var(--foreground) 90%, white 10%);
		-webkit-mask-image: var(--os-icon);
		mask-image: var(--os-icon);
		-webkit-mask-repeat: no-repeat;
		mask-repeat: no-repeat;
		-webkit-mask-position: center;
		mask-position: center;
		-webkit-mask-size: contain;
		mask-size: contain;
		opacity: 0.95;
	}

	.r4d-os-name {
		margin: 0;
		font-size: 1.02rem;
		font-weight: 700;
		color: color-mix(in srgb, var(--foreground) 96%, white 4%);
	}

	.r4d-store-list {
		display: flex;
		flex-direction: column;
		gap: 0.45rem;
	}

	.r4d-disclaimer-grid {
		display: grid;
		grid-template-columns: 1fr;
		gap: 1rem;
	}

	.r4d-disclaimer-col {
		min-height: 1px;
	}

	@media (min-width: 640px) {
		.r4d-store-grid {
			grid-template-columns: repeat(2, minmax(0, 1fr));
		}
	}

	@media (min-width: 900px) {
		.r4d-store-grid {
			grid-template-columns: repeat(4, minmax(0, 1fr));
		}

		.r4d-disclaimer-grid {
			grid-template-columns: repeat(2, minmax(0, 1fr));
		}
	}
</style>
