---
import Tabs from "./ui/Tabs.astro"
import TabContent from "./ui/TabContent.astro"

export interface ArchUrls {
	isoUrl?: string
	qcow2Url?: string
	imgUrl?: string
}

export interface Props {
	title: string
	logo: string
	stack: string
	description: string
	pros: string[]
	cons: string[]
	status: "available" | "coming-soon" | "planned"
	x86_64?: ArchUrls
	aarch64?: ArchUrls
	x86_64Date: string
	aarch64Date: string
	minRam: string
	recRam: string
	minDisk: string
	recDisk: string
}

const {
	title,
	logo,
	stack,
	description,
	pros,
	cons,
	status,
	x86_64,
	aarch64,
	x86_64Date,
	aarch64Date,
	minRam,
	recRam,
	minDisk,
	recDisk,
} = Astro.props

const cardId = title.toLowerCase().replace(/\s+/g, '-')
const archTabs = [
	{ id: "x86_64", label: "x86_64" },
	{ id: "aarch64", label: "AArch64" },
]
---

<div class="bg-card border overflow-hidden text-sm">
	<div class="flex flex-col sm:flex-row">
		<!-- OS Info -->
		<div class="px-5 py-5 flex flex-col flex-1">
			<div class="flex items-center gap-3 mb-2">
				<img src={logo} alt={title} width="40" height="40" loading="lazy" class="size-10" />
				<h3 class="text-lg font-medium">{title}</h3>
			</div>

			<p class="font-mono text-muted-foreground mb-2">{stack}</p>
			<p class="text-muted-foreground mb-3">{description}</p>

			<div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
				<!-- Pros -->
				<ul class="space-y-1">
					{pros.map((pro) => (
						<li class="flex items-start gap-2">
							<span class="text-green-500 shrink-0">+</span>
							<span>{pro}</span>
						</li>
					))}
				</ul>

				<!-- Cons -->
				<ul class="space-y-1">
					{cons.map((con) => (
						<li class="flex items-start gap-2">
							<span class="text-red-400 shrink-0">âˆ’</span>
							<span>{con}</span>
						</li>
					))}
				</ul>
			</div>
		</div>

		<!-- Download -->
		<div class="bg-black/20 px-5 py-5 flex flex-col sm:w-56 sm:shrink-0">
			<h4 class="font-medium mb-3">Download {title}</h4>
			<div class="text-muted-foreground mb-3">
				<table class="w-full">
					<thead>
						<tr class="text-muted-foreground/70">
							<td></td>
							<td class="text-right pb-0.5 pl-3">Min</td>
							<td class="text-right pb-0.5 pl-3">Rec</td>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td class="font-medium">RAM</td>
							<td class="text-right pl-3">{minRam}</td>
							<td class="text-right pl-3">{recRam}</td>
						</tr>
						<tr>
							<td class="font-medium">Disk</td>
							<td class="text-right pl-3">{minDisk}</td>
							<td class="text-right pl-3">{recDisk}</td>
						</tr>
					</tbody>
				</table>
			</div>

				<!-- Arch tabs -->
			<Tabs tabs={archTabs} name={cardId} defaultTab="x86_64" class="mt-auto mb-3" />

			<!-- x86_64 downloads -->
			<TabContent name={cardId} tabId="x86_64" default class="flex flex-col gap-2">
				{status === "available" && x86_64 ? (
					<>
						{x86_64.isoUrl ? (
							<a
								href={x86_64.isoUrl}
								class="inline-flex items-center justify-center gap-2 bg-primary text-primary-foreground h-10 px-4 hover:bg-primary/90 transition-colors select-none"
							>
								<svg class="size-5" viewBox="0 0 256 256" fill="currentColor">
									<path d="M224 152v56a16 16 0 0 1-16 16H48a16 16 0 0 1-16-16v-56a8 8 0 0 1 16 0v56h160v-56a8 8 0 0 1 16 0Zm-101.66 5.66a8 8 0 0 0 11.32 0l40-40a8 8 0 0 0-11.32-11.32L136 132.69V40a8 8 0 0 0-16 0v92.69l-26.34-26.35a8 8 0 0 0-11.32 11.32Z"/>
								</svg>
								ISO
							</a>
						) : (
							<span class="flex items-center justify-center bg-muted text-muted-foreground h-10 px-4 text-center">
								ISO
							</span>
						)}

						{x86_64.qcow2Url ? (
							<a
								href={x86_64.qcow2Url}
								class="inline-flex items-center justify-center gap-2 bg-muted text-foreground h-10 px-4 hover:bg-muted/70 transition-colors select-none"
							>
								<svg class="size-5" viewBox="0 0 256 256" fill="currentColor">
									<path d="M224 152v56a16 16 0 0 1-16 16H48a16 16 0 0 1-16-16v-56a8 8 0 0 1 16 0v56h160v-56a8 8 0 0 1 16 0Zm-101.66 5.66a8 8 0 0 0 11.32 0l40-40a8 8 0 0 0-11.32-11.32L136 132.69V40a8 8 0 0 0-16 0v92.69l-26.34-26.35a8 8 0 0 0-11.32 11.32Z"/>
								</svg>
								QCOW2
							</a>
						) : (
							<span class="flex items-center justify-center bg-muted text-muted-foreground h-10 px-4 text-center">
								QCOW2
							</span>
						)}

						{x86_64.imgUrl ? (
							<a
								href={x86_64.imgUrl}
								class="inline-flex items-center justify-center gap-2 bg-muted text-foreground h-10 px-4 hover:bg-muted/70 transition-colors select-none"
							>
								<svg class="size-5" viewBox="0 0 256 256" fill="currentColor">
									<path d="M224 152v56a16 16 0 0 1-16 16H48a16 16 0 0 1-16-16v-56a8 8 0 0 1 16 0v56h160v-56a8 8 0 0 1 16 0Zm-101.66 5.66a8 8 0 0 0 11.32 0l40-40a8 8 0 0 0-11.32-11.32L136 132.69V40a8 8 0 0 0-16 0v92.69l-26.34-26.35a8 8 0 0 0-11.32 11.32Z"/>
								</svg>
								IMG
							</a>
						) : (
							<span class="flex items-center justify-center bg-muted text-muted-foreground h-10 px-4 text-center">
								IMG
							</span>
						)}
					</>
				) : (
					<>
						<span class="flex items-center justify-center bg-muted text-muted-foreground h-10 px-4 text-center">
							ISO
						</span>
						<span class="flex items-center justify-center bg-muted text-muted-foreground h-10 px-4 text-center">
							QCOW2
						</span>
						<span class="flex items-center justify-center bg-muted text-muted-foreground h-10 px-4 text-center">
							IMG
						</span>
						<span class="text-xs text-muted-foreground text-center">{x86_64Date}</span>
					</>
				)}
			</TabContent>

			<!-- AArch64 downloads -->
			<TabContent name={cardId} tabId="aarch64" class="flex flex-col gap-2">
				{status === "available" && aarch64 ? (
					<>
						{aarch64.isoUrl ? (
							<a
								href={aarch64.isoUrl}
								class="inline-flex items-center justify-center gap-2 bg-primary text-primary-foreground h-10 px-4 hover:bg-primary/90 transition-colors select-none"
							>
								<svg class="size-5" viewBox="0 0 256 256" fill="currentColor">
									<path d="M224 152v56a16 16 0 0 1-16 16H48a16 16 0 0 1-16-16v-56a8 8 0 0 1 16 0v56h160v-56a8 8 0 0 1 16 0Zm-101.66 5.66a8 8 0 0 0 11.32 0l40-40a8 8 0 0 0-11.32-11.32L136 132.69V40a8 8 0 0 0-16 0v92.69l-26.34-26.35a8 8 0 0 0-11.32 11.32Z"/>
								</svg>
								ISO
							</a>
						) : (
							<span class="flex items-center justify-center bg-muted text-muted-foreground h-10 px-4 text-center">
								ISO
							</span>
						)}

						{aarch64.qcow2Url ? (
							<a
								href={aarch64.qcow2Url}
								class="inline-flex items-center justify-center gap-2 bg-muted text-foreground h-10 px-4 hover:bg-muted/70 transition-colors select-none"
							>
								<svg class="size-5" viewBox="0 0 256 256" fill="currentColor">
									<path d="M224 152v56a16 16 0 0 1-16 16H48a16 16 0 0 1-16-16v-56a8 8 0 0 1 16 0v56h160v-56a8 8 0 0 1 16 0Zm-101.66 5.66a8 8 0 0 0 11.32 0l40-40a8 8 0 0 0-11.32-11.32L136 132.69V40a8 8 0 0 0-16 0v92.69l-26.34-26.35a8 8 0 0 0-11.32 11.32Z"/>
								</svg>
								QCOW2
							</a>
						) : (
							<span class="flex items-center justify-center bg-muted text-muted-foreground h-10 px-4 text-center">
								QCOW2
							</span>
						)}

						{aarch64.imgUrl ? (
							<a
								href={aarch64.imgUrl}
								class="inline-flex items-center justify-center gap-2 bg-muted text-foreground h-10 px-4 hover:bg-muted/70 transition-colors select-none"
							>
								<svg class="size-5" viewBox="0 0 256 256" fill="currentColor">
									<path d="M224 152v56a16 16 0 0 1-16 16H48a16 16 0 0 1-16-16v-56a8 8 0 0 1 16 0v56h160v-56a8 8 0 0 1 16 0Zm-101.66 5.66a8 8 0 0 0 11.32 0l40-40a8 8 0 0 0-11.32-11.32L136 132.69V40a8 8 0 0 0-16 0v92.69l-26.34-26.35a8 8 0 0 0-11.32 11.32Z"/>
								</svg>
								IMG
							</a>
						) : (
							<span class="flex items-center justify-center bg-muted text-muted-foreground h-10 px-4 text-center">
								IMG
							</span>
						)}
					</>
				) : (
					<>
						<span class="flex items-center justify-center bg-muted text-muted-foreground h-10 px-4 text-center">
							ISO
						</span>
						<span class="flex items-center justify-center bg-muted text-muted-foreground h-10 px-4 text-center">
							QCOW2
						</span>
						<span class="flex items-center justify-center bg-muted text-muted-foreground h-10 px-4 text-center">
							IMG
						</span>
						<span class="text-xs text-muted-foreground text-center">{aarch64Date}</span>
					</>
				)}
			</TabContent>
		</div>
	</div>
</div>
