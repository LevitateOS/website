<button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme" type="button">
	<span class="theme-toggle__option" data-theme-option="dark">
		<span class="theme-toggle__text theme-toggle__text--full">CHARCOAL</span>
		<span class="theme-toggle__text theme-toggle__text--short">CHR</span>
	</span>
	<span class="theme-toggle__option" data-theme-option="light">
		<span class="theme-toggle__text theme-toggle__text--full">PAPER</span>
		<span class="theme-toggle__text theme-toggle__text--short">PPR</span>
	</span>
</button>

<style>
	.theme-toggle {
		display: inline-flex;
		height: 2.25rem;
		padding: 0.18rem;
		gap: 0.18rem;
		border-radius: 4px;
		border: 1px solid var(--border);
		background: var(--card);
		font-family: var(--font-mono);
		font-size: 0.64rem;
		font-weight: 600;
		letter-spacing: 0.1em;
	}

	.theme-toggle__option {
		display: inline-flex;
		align-items: center;
		justify-content: center;
		padding: 0 0.45rem;
		border-radius: 3px;
		color: var(--muted-foreground);
		border: 1px solid transparent;
	}

	.theme-toggle__text--short {
		display: none;
	}

	.theme-toggle__option[data-active] {
		background: var(--secondary);
		color: var(--foreground);
		border-color: var(--border);
	}

	@media (max-width: 420px) {
		.theme-toggle {
			height: 2.05rem;
			padding: 0.14rem;
			gap: 0.14rem;
			font-size: 0.58rem;
			letter-spacing: 0.08em;
		}

		.theme-toggle__option {
			padding: 0 0.35rem;
		}

		.theme-toggle__text--full {
			display: none;
		}

		.theme-toggle__text--short {
			display: inline;
		}
	}
</style>

<script>
	function initTheme() {
		const toggle = document.getElementById("theme-toggle")
		if (!toggle) return
		const nextToggle = toggle.cloneNode(true) as HTMLElement
		toggle.parentNode?.replaceChild(nextToggle, toggle)

		function updateOptions() {
			const isDark = document.documentElement.classList.contains("dark")
			const darkOption = nextToggle.querySelector('[data-theme-option="dark"]')
			const lightOption = nextToggle.querySelector('[data-theme-option="light"]')
			darkOption?.toggleAttribute("data-active", isDark)
			lightOption?.toggleAttribute("data-active", !isDark)
		}

		nextToggle.addEventListener("click", () => {
			const isDark = document.documentElement.classList.toggle("dark")
			localStorage.setItem("theme", isDark ? "dark" : "light")
			updateOptions()
		})

		updateOptions()
	}

	initTheme()
	document.addEventListener("astro:page-load", initTheme)
</script>
